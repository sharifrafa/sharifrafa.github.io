<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MusicBrainz App</title>

  <!-- Bootstrap CDN -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
</head>

<body class="bg-dark text-light">

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
      <a class="navbar-brand" href="#" onclick="showPage('home')">MusicBrainz App</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarNav"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="#" onclick="showPage('home')">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#" onclick="showPage('search')">Search Artists</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- ====================== HOME PAGE ====================== -->
  <section id="home" class="container py-5">
    <div class="card bg-secondary text-light p-4 text-center shadow-lg rounded">
      <h1 class="mb-3">Welcome to the MusicBrainz Explorer</h1>
      <p class="fs-5">
        This tool allows you to search for artists and browse their music releases
        using the official <strong>MusicBrainz REST API</strong>.
      </p>
      <p class="fs-6">
        Click “Search Artists” above to begin!
      </p>
    </div>
  </section>

  <!-- ====================== SEARCH PAGE ====================== -->
  <section id="search" class="container py-5" style="display:none;">
    <h2 class="mb-3">Search for an Artist</h2>

    <div class="input-group mb-3">
      <input type="text" id="artistInput" class="form-control" placeholder="Enter artist name...">
      <button class="btn btn-primary" onclick="searchArtist()">Search</button>
    </div>

    <div id="artistResults"></div>
    <hr class="my-4" />

    <h3>Artist Releases</h3>
    <div id="releases"></div>
  </section>

  <!-- ====================== JAVASCRIPT ====================== -->
  <script>
    // Navigate between "pages"
    function showPage(page) {
      document.getElementById("home").style.display =
        page === "home" ? "block" : "none";
      document.getElementById("search").style.display =
        page === "search" ? "block" : "none";
    }

    // Search for an artist
    async function searchArtist() {
      const artistName = document.getElementById("artistInput").value.trim();
      const resultDiv = document.getElementById("artistResults");
      resultDiv.innerHTML = "";
      document.getElementById("releases").innerHTML = "";

      if (!artistName) return;

      const url = `https://musicbrainz.org/ws/2/artist?query=${encodeURIComponent(
        artistName
      )}&fmt=json`;

      const response = await fetch(url);
      const data = await response.json();

      if (!data.artists || data.artists.length === 0) {
        resultDiv.innerHTML = "<p>No artists found.</p>";
        return;
      }

      data.artists.forEach((artist) => {
        const card = document.createElement("div");
        card.className = "card bg-secondary text-light my-2 p-3";

        card.innerHTML = `
          <h5>${artist.name}</h5>
          <p><strong>Country:</strong> ${artist.country || "Unknown"}</p>
          <p><strong>Type:</strong> ${artist.type || "Unknown"}</p>
          <button class="btn btn-light btn-sm" onclick="getReleases('${artist.id}', '${artist.name}')">
            View Releases
          </button>
        `;

        resultDiv.appendChild(card);
      });
    }

    // Fetch releases of an artist by ID and scroll to releases section
    async function getReleases(artistId, name) {
      const releasesDiv = document.getElementById("releases");
      releasesDiv.innerHTML = `<h4>Loading releases for ${name}...</h4>`;

      const url = `https://musicbrainz.org/ws/2/release?artist=${artistId}&fmt=json`;
      const response = await fetch(url);
      const data = await response.json();

      releasesDiv.innerHTML = `<h4>Releases by ${name}</h4>`;

      if (!data.releases || data.releases.length === 0) {
        releasesDiv.innerHTML += "<p>No releases found.</p>";
        // Scroll even if empty
        releasesDiv.scrollIntoView({ behavior: "smooth" });
        return;
      }

      data.releases.forEach((release) => {
        const item = document.createElement("div");
        item.className = "card bg-secondary text-light my-2 p-3";

        item.innerHTML = `
          <h5>${release.title}</h5>
          <p><strong>Date:</strong> ${release.date || "Unknown"}</p>
          <p><strong>Status:</strong> ${release.status || "Unknown"}</p>
        `;

        releasesDiv.appendChild(item);
      });

      // Smooth scroll to releases section
      releasesDiv.scrollIntoView({ behavior: "smooth" });
    }
  </script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
